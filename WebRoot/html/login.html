<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8" />
<title>后台登录</title>
<script src='/learningResources/static/common/header.js'></script>
</head>

<body onload='load()' style='display:none;'>
<input type="hidden" id="TenantId" name="TenantId" value="" />
<div class="loginWraper">
  <div id="loginform" class="loginBox">
    <div class="form form-horizontal">
      <div class="row cl">
        <label class="form-label col-xs-3"><i class="Hui-iconfont">&#xe60d;</i></label>
        <div class="formControls col-xs-8">
          <input id="username" name="" type="text" placeholder="账户" class="input-text size-L">
        </div>
      </div>
      <div class="row cl">
        <label class="form-label col-xs-3"><i class="Hui-iconfont">&#xe60e;</i></label>
        <div class="formControls col-xs-8">
          <input id="password" name="" type="password" placeholder="密码" class="input-text size-L">
        </div>
      </div>
      <div class="row cl" id="msgDiv" style='display:none;'>
        <label class="form-label col-xs-3"></label>
        <div class="formControls col-xs-8">
          <span id="msg" style='color:red;'></span>
        </div>
      </div>
      <div class="row cl">
        <div class="formControls col-xs-8 col-xs-offset-3">
          <input name="" type="submit" onclick="login()" class="btn btn-success radius size-L" value="&nbsp;登&nbsp;&nbsp;&nbsp;&nbsp;录&nbsp;">
          <a class="btn btn-default radius size-L" style='margin-left: 20px;' href='/learningResources/html/register.html'>&nbsp;注&nbsp;&nbsp;&nbsp;&nbsp;册&nbsp;</a>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="footer">Copyright by <a href="#">learning resources</a></div>

</body>
</html>

<script>
// 查看是否已存在session，若存在，跳转到首页
function load() {
	$.ajax({
		type: 'GET',
		url: '/learningResources/user.do?method=validateUser',
		dataType: 'json',
		success: function(result) {
			if (result.status) {
				location.href = '/learningResources/html/index.html';
			} else {
				$('body').show();
			}
		},
		error: function() {
			alert('error')
		}
	})
}

function login(){
	$.ajax({
		type: 'POST',
		url: '/learningResources/user.do?method=login',
		data: {'username': $('#username').val(), 'password': $('#password').val(), 'method': 'loginValidate'},
		dataType: 'json',
		success: function(result){
			if (result.status) {
				location.href = '/learningResources/html/index.html';
			} else {
				$('#msg').html('用户名或密码错误');
				$('#msgDiv').show();
			}
		},
		error: function(xhr, error){
			console.info(error);
		}
	})
}
</script>